<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Will you be my Valentine Andrew Getzow?</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
      /* Moving hearts background */
      #hearts {
        position: fixed;
        inset: 0;
        overflow: hidden;
        pointer-events: none;
        z-index: 0;
      }
      .heart {
        position: absolute;
        bottom: -40px;
        will-change: transform, opacity;
        animation: floatUp linear forwards;
        filter: drop-shadow(0 6px 10px rgba(0,0,0,0.08));
        user-select: none;
      }
      @keyframes floatUp {
        0%   { transform: translateY(0) translateX(0) scale(1); opacity: 0; }
        10%  { opacity: 0.85; }
        100% { transform: translateY(-120vh) translateX(var(--drift)) scale(1.15); opacity: 0; }
      }

      /* Keep card above hearts */
      .card { position: relative; z-index: 1; }

      /* Smooth scaling */
      #yesBtn { transition: transform 0.2s ease; }

      /* If a gif fails you won't see a harsh white block */
      #valImage {
        background: linear-gradient(135deg, rgba(255,192,203,0.25), rgba(173,216,230,0.25));
      }

      /* ---------------- Heart-shaped buttons (SMALLER) ---------------- */
      .heart-btn{
        --size: 48px;
        width: var(--size);
        height: var(--size);
        position: relative;
        border: 0;
        cursor: pointer;
        background: #ef4444;              /* Tailwind red-500 */
        transform: rotate(-45deg);
        border-radius: 10px;
        box-shadow: 0 8px 14px rgba(0,0,0,.14);
        transition: transform .15s ease, filter .15s ease;
        overflow: visible;
      }

      .heart-btn::before,
      .heart-btn::after{
        content:"";
        position:absolute;
        width: var(--size);
        height: var(--size);
        background: inherit;
        border-radius: 999px;
      }

      .heart-btn::before{
        top: calc(-1 * var(--size) / 2);
        left: 0;
      }
      .heart-btn::after{
        top: 0;
        left: calc(var(--size) / 2);
      }

      .heart-btn span{
        position:absolute;
        inset: 0;
        display:flex;
        align-items:center;
        justify-content:center;
        transform: rotate(45deg);
        color:#fff;
        font-weight: 800;
        font-size: 11px;
        letter-spacing: .3px;
        text-transform: uppercase;
        user-select: none;
      }

      .heart-btn:hover{ filter: brightness(1.05); transform: rotate(-45deg) scale(1.05); }
      .heart-btn:active{ transform: rotate(-45deg) scale(.95); }

      .heart-btn.no{ background:#f43f5e; }
    </style>
  </head>

  <body class="min-h-screen bg-pink-50 flex items-center justify-center p-6">
    <div id="hearts" aria-hidden="true"></div>

    <div class="card bg-white rounded-2xl shadow-lg p-6 max-w-md w-full text-center">
      <h1 class="text-2xl font-bold mb-4">Will you be my Valentine Andrew Getzow? Pretty Pleases? ðŸ’˜</h1>

      <img
        id="valImage"
        class="w-full h-64 object-cover rounded-xl mb-5"
        alt="Valentine gif"
      />

      <!-- HEART BUTTONS (smaller) -->
      <div class="flex gap-8 justify-center">
        <button id="yesBtn" class="heart-btn yes" type="button" aria-label="Yes">
          <span>Yes</span>
        </button>

        <button id="noBtn" class="heart-btn no" type="button" aria-label="No">
          <span>No</span>
        </button>
      </div>

      <p id="hint" class="text-sm text-gray-500 mt-4">Tip: click a button. If a GIF host blocks embeds, itâ€™ll auto-try another link.</p>
    </div>

    <script>
      // ------------------ Moving hearts ------------------
      const heartsLayer = document.getElementById("hearts");

      function spawnHeart() {
        const el = document.createElement("span");
        el.className = "heart";
        el.textContent = Math.random() > 0.25 ? "ðŸ’—" : "ðŸ’–";

        const left = Math.random() * 100;          // vw
        const size = 14 + Math.random() * 28;      // px
        const dur  = 5 + Math.random() * 7;        // sec
        const drift = (Math.random() * 60 - 30) + "px";

        el.style.left = left + "vw";
        el.style.fontSize = size + "px";
        el.style.opacity = (0.30 + Math.random() * 0.50).toFixed(2);
        el.style.animationDuration = dur + "s";
        el.style.setProperty("--drift", drift);

        heartsLayer.appendChild(el);
        setTimeout(() => el.remove(), dur * 1000 + 100);
      }

      for (let i = 0; i < 14; i++) spawnHeart();
      setInterval(spawnHeart, 220);

      // ------------------ GIF loader (tries multiple URLs) ------------------
      const valImage = document.getElementById("valImage");
      const hint = document.getElementById("hint");

      function setImageTry(urls, failMessage) {
        let i = 0;

        const tryNext = () => {
          if (i >= urls.length) {
            hint.textContent = failMessage;
            return;
          }
          const url = urls[i++];

          const probe = new Image();
          probe.onload = () => {
            valImage.src = url;
            hint.textContent = "";
          };
          probe.onerror = () => tryNext();
          probe.src = url;
        };

        tryNext();
      }

      // ------------------ Buttons ------------------
      const yesBtn = document.getElementById("yesBtn");
      const noBtn = document.getElementById("noBtn");

      const GIFS = {
        start: [
          "https://media1.tenor.com/m/rcvI6iu2HrYAAAAd/pokemon-eevee-eevee.gif",
        ],
        yesMain: [
          "https://media1.tenor.com/m/hmEGDJNxK0cAAAAd/eevee.gif"
        ],
        yesFinal: [
          "https://media1.tenor.com/m/hmEGDJNxK0cAAAAd/eevee.gif",
          "https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExcnd5OW94bW81Zzg5MXpyMHB6eTE0azRiMGU5OHhlYTl4MmNiMHh6biZlcD12MV9naWZzX3NlYXJjaCZjdD1n/TqK5V0YnrWaR2/200.gif"
        ],
        no: [
          "https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExanJvMHd5MXBwYjJsaWUxeTNrc3ptdHYzNnpndDhncXoyYzN0bnJxZSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/oabY4xGwzUB8c/giphy.gif"
        ]
      };

      setImageTry(GIFS.start, "Start GIF failed to load.");

      // ------------------ "Chest opening" style fanfare (original) ------------------
      function playGlueSong() {
        try {
          const AudioCtx = window.AudioContext || window.webkitAudioContext;
          const ctx = new AudioCtx();
          if (ctx.state === "suspended") ctx.resume();

          const now = ctx.currentTime;

          const bpm = 132;
          const beat = 60 / bpm;

          const lead = [
            { note: "C5", beats: 0.5 }, { note: "E5", beats: 0.5 }, { note: "G5", beats: 0.5 }, { note: "C6", beats: 1.5 },
            { note: "B5", beats: 0.5 }, { note: "C6", beats: 2 },
            { note: "G5", beats: 0.5 }, { note: "C6", beats: 2.5 }
          ];

          const harmony = [
            { note: "E4", beats: 0.5 }, { note: "G4", beats: 0.5 }, { note: "C5", beats: 0.5 }, { note: "E5", beats: 1.5 },
            { note: "D5", beats: 0.5 }, { note: "E5", beats: 2 },
            { note: "C5", beats: 0.5 }, { note: "E5", beats: 2.5 }
          ];

          const bass = [
            { note: "C3", beats: 1 }, { note: "REST", beats: 1 },
            { note: "G3", beats: 1 }, { note: "REST", beats: 1 },
            { note: "C3", beats: 2 },
          ];

          const noteToFreq = (note) => {
            if (note === "REST") return null;
            const m = /^([A-G])(#|b)?(\d)$/.exec(note);
            if (!m) return null;

            const [, letter, accidental, octaveStr] = m;
            const octave = Number(octaveStr);
            const SEMI = { C: 0, D: 2, E: 4, F: 5, G: 7, A: 9, B: 11 };

            let n = SEMI[letter];
            if (accidental === "#") n += 1;
            if (accidental === "b") n -= 1;

            const midi = (octave + 1) * 12 + n;
            return 440 * Math.pow(2, (midi - 69) / 12);
          };

          function schedule(sequence, { type = "triangle", volume = 0.12, offset = 0 } = {}) {
            let t = now + offset;

            for (const step of sequence) {
              const dur = step.beats * beat;
              const freq = noteToFreq(step.note);

              if (freq) {
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();
                osc.type = type;
                osc.frequency.setValueAtTime(freq, t);

                const attack = Math.min(0.015, dur * 0.25);
                const release = Math.min(0.08, dur * 0.4);

                gain.gain.setValueAtTime(0, t);
                gain.gain.linearRampToValueAtTime(volume, t + attack);
                gain.gain.setValueAtTime(volume, t + Math.max(attack, dur - release));
                gain.gain.linearRampToValueAtTime(0, t + dur);

                osc.connect(gain).connect(ctx.destination);
                osc.start(t);
                osc.stop(t + dur);
              }

              t += dur;
            }

            return t;
          }

          const t1 = schedule(lead,    { type: "triangle", volume: 0.14, offset: 0 });
          const t2 = schedule(harmony, { type: "sine",     volume: 0.10, offset: 0.02 });
          const t3 = schedule(bass,    { type: "square",   volume: 0.06, offset: 0 });

          const end = Math.max(t1, t2, t3);
          setTimeout(() => ctx.close().catch(() => {}), Math.ceil((end - now + 0.2) * 1000));
        } catch {}
      }

      let yesFinalTimer = null;

      yesBtn.addEventListener("click", () => {
        setImageTry(GIFS.yesMain, "YES GIF failed to load.");
        hint.textContent = "You are now my Valentine FOREVER...er I mean um, for uh 2026! ðŸ’™";
        noBtn.style.display = "none";

        playGlueSong();
        confetti({ particleCount: 250, spread: 80, origin: { y: 0.6 } });

        if (yesFinalTimer) clearTimeout(yesFinalTimer);
        yesFinalTimer = setTimeout(() => {
          setImageTry(GIFS.yesFinal, "Final Eevee GIF failed to load.");
        }, 2000);
      });

      noBtn.addEventListener("click", () => {
        setImageTry(GIFS.no, "NO GIF failed to load.");
        hint.textContent = "No (Are you sure about that?) ðŸ˜³";
      });
    </script>
  </body>
</html>
