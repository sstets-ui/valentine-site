<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Will you be my Valentine Andrew Getzow?</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
      /* Moving hearts background */
      #hearts {
        position: fixed;
        inset: 0;
        overflow: hidden;
        pointer-events: none;
        z-index: 0;
      }
      .heart {
        position: absolute;
        bottom: -40px;
        will-change: transform, opacity;
        animation: floatUp linear forwards;
        filter: drop-shadow(0 6px 10px rgba(0,0,0,0.08));
        user-select: none;
      }
      @keyframes floatUp {
        0%   { transform: translateY(0) translateX(0) scale(1); opacity: 0; }
        10%  { opacity: 0.85; }
        100% { transform: translateY(-120vh) translateX(var(--drift)) scale(1.15); opacity: 0; }
      }

      /* Keep card above hearts */
      .card { position: relative; z-index: 1; }

      /* If a gif fails you won't see a harsh white block */
      #valImage {
        background: linear-gradient(135deg, rgba(255,192,203,0.25), rgba(173,216,230,0.25));
      }

      /* --------- Neat heart buttons (SVG) --------- */
      .svg-heart{
        width: 56px;
        height: 50px;
        border: 0;
        background: transparent;
        padding: 0;
        cursor: pointer;
        position: relative;
        filter: drop-shadow(0 10px 14px rgba(0,0,0,.16));
        transition: transform .12s ease, filter .12s ease;
        will-change: transform; /* âœ… helps smooth scaling/moving */
      }

      .svg-heart svg{
        width: 100%;
        height: 100%;
        display: block;
      }

      .svg-heart.yes path{ fill: #ef4444; } /* red */
      .svg-heart.no  path{ fill: #f43f5e; } /* rose */

      /* âœ… Text nudge so it doesn't sit in the heart dip */
      .svg-heart span{
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        transform: translateY(-4px);
        color: white;
        font-weight: 900;
        font-size: 11px;
        letter-spacing: .7px;
        text-shadow: 0 1px 2px rgba(0,0,0,.25);
        user-select: none;
        pointer-events: none;
      }

      .svg-heart:hover{
        transform: scale(1.06);
        filter: drop-shadow(0 12px 18px rgba(0,0,0,.18));
      }
      .svg-heart:active{ transform: scale(.96); }

      .svg-heart:focus-visible{
        outline: 3px solid rgba(239, 68, 68, .35);
        outline-offset: 6px;
      }
    </style>
  </head>

  <body class="min-h-screen bg-pink-50 flex items-center justify-center p-6">
    <div id="hearts" aria-hidden="true"></div>

    <div class="card bg-white rounded-2xl shadow-lg p-6 max-w-md w-full text-center">
      <h1 class="text-2xl font-bold mb-4">Will you be my Valentine Andrew Getzow? Pretty Pleasesss? ðŸ’˜</h1>

      <img
        id="valImage"
        class="w-full h-64 object-cover rounded-xl mb-5"
        alt="Valentine gif"
      />

      <!-- NEAT HEART BUTTONS -->
      <div class="flex gap-6 justify-center mt-2">
        <button id="yesBtn" class="svg-heart yes" type="button" aria-label="Yes">
          <svg viewBox="0 0 32 29" aria-hidden="true">
            <path d="M23.6,0c-3,0-5.2,1.7-6.6,3.6C15.6,1.7,13.4,0,10.4,0C4.9,0,0.8,4.9,1.1,10.4
              c0.6,9.2,14.9,18.2,15.9,18.6c1-0.4,15.3-9.4,15.9-18.6C33.2,4.9,29.1,0,23.6,0z"/>
          </svg>
          <span>YES</span>
        </button>

        <button id="noBtn" class="svg-heart no" type="button" aria-label="No">
          <svg viewBox="0 0 32 29" aria-hidden="true">
            <path d="M23.6,0c-3,0-5.2,1.7-6.6,3.6C15.6,1.7,13.4,0,10.4,0C4.9,0,0.8,4.9,1.1,10.4
              c0.6,9.2,14.9,18.2,15.9,18.6c1-0.4,15.3-9.4,15.9-18.6C33.2,4.9,29.1,0,23.6,0z"/>
          </svg>
          <span>NO</span>
        </button>
      </div>

      <p id="hint" class="text-sm text-gray-500 mt-4">
        Tip: click a button. If a GIF host blocks embeds, itâ€™ll auto-try another link.
      </p>
    </div>

    <script>
      // ------------------ Moving hearts ------------------
      const heartsLayer = document.getElementById("hearts");

      function spawnHeart() {
        const el = document.createElement("span");
        el.className = "heart";
        el.textContent = Math.random() > 0.25 ? "ðŸ’—" : "ðŸ’–";

        const left = Math.random() * 100;          // vw
        const size = 14 + Math.random() * 28;      // px
        const dur  = 5 + Math.random() * 7;        // sec
        const drift = (Math.random() * 60 - 30) + "px";

        el.style.left = left + "vw";
        el.style.fontSize = size + "px";
        el.style.opacity = (0.30 + Math.random() * 0.50).toFixed(2);
        el.style.animationDuration = dur + "s";
        el.style.setProperty("--drift", drift);

        heartsLayer.appendChild(el);
        setTimeout(() => el.remove(), dur * 1000 + 100);
      }

      for (let i = 0; i < 14; i++) spawnHeart();
      setInterval(spawnHeart, 220);

      // ------------------ GIF loader (tries multiple URLs) ------------------
      const valImage = document.getElementById("valImage");
      const hint = document.getElementById("hint");

      function setImageTry(urls, failMessage) {
        let i = 0;

        const tryNext = () => {
          if (i >= urls.length) {
            hint.textContent = failMessage;
            return;
          }
          const url = urls[i++];

          const probe = new Image();
          probe.onload = () => {
            valImage.src = url;
            hint.textContent = "";
          };
          probe.onerror = () => tryNext();
          probe.src = url;
        };

        tryNext();
      }

      // ------------------ Buttons ------------------
      const yesBtn = document.getElementById("yesBtn");
      const noBtn = document.getElementById("noBtn");

      const GIFS = {
        start: [
          "https://media1.tenor.com/m/rcvI6iu2HrYAAAAd/pokemon-eevee-eevee.gif",
        ],
        yesMain: [
          "https://media1.tenor.com/m/hmEGDJNxK0cAAAAd/eevee.gif"
        ],
        yesFinal: [
          "https://media1.tenor.com/m/hmEGDJNxK0cAAAAd/eevee.gif",
          "https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExcnd5OW94bW81Zzg5MXpyMHB6eTE0azRiMGU5OHhlYTl4MmNiMHh6biZlcD12MV9naWZzX3NlYXJjaCZjdD1n/TqK5V0YnrWaR2/200.gif"
        ],
        no: [
          "https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExanJvMHd5MXBwYjJsaWUxeTNrc3ptdHYzNnpndDhncXoyYzN0bnJxZSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/oabY4xGwzUB8c/giphy.gif"
        ]
      };

      setImageTry(GIFS.start, "Start GIF failed to load.");

      // ------------------ More complicated chest-fanfare (original) ------------------
      function playGlueSong() {
        try {
          const AudioCtx = window.AudioContext || window.webkitAudioContext;
          const ctx = new AudioCtx();
          if (ctx.state === "suspended") ctx.resume();

          const now = ctx.currentTime;

          const bpm = 132;
          const beat = 60 / bpm;

          // Small echo to make it feel more "game-y"
          const delay = ctx.createDelay(1.0);
          delay.delayTime.value = 0.12;

          const feedback = ctx.createGain();
          feedback.gain.value = 0.25;

          const wet = ctx.createGain();
          wet.gain.value = 0.35;

          const dry = ctx.createGain();
          dry.gain.value = 0.85;

          delay.connect(feedback);
          feedback.connect(delay);

          delay.connect(wet);
          wet.connect(ctx.destination);
          dry.connect(ctx.destination);

          const noteToFreq = (note) => {
            if (note === "REST") return null;
            const m = /^([A-G])(#|b)?(\d)$/.exec(note);
            if (!m) return null;

            const [, letter, accidental, octaveStr] = m;
            const octave = Number(octaveStr);
            const SEMI = { C: 0, D: 2, E: 4, F: 5, G: 7, A: 9, B: 11 };

            let n = SEMI[letter];
            if (accidental === "#") n += 1;
            if (accidental === "b") n -= 1;

            const midi = (octave + 1) * 12 + n;
            return 440 * Math.pow(2, (midi - 69) / 12);
          };

          function schedule(sequence, {
            type = "triangle",
            volume = 0.12,
            offset = 0,
            detune = 0,
            toDelay = true
          } = {}) {
            let t = now + offset;

            for (const step of sequence) {
              const dur = step.beats * beat;
              const freq = noteToFreq(step.note);

              if (freq) {
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();

                osc.type = type;
                osc.frequency.setValueAtTime(freq, t);
                osc.detune.setValueAtTime(detune, t);

                const attack = Math.min(0.012, dur * 0.25);
                const release = Math.min(0.09, dur * 0.45);

                gain.gain.setValueAtTime(0, t);
                gain.gain.linearRampToValueAtTime(volume, t + attack);
                gain.gain.setValueAtTime(volume, t + Math.max(attack, dur - release));
                gain.gain.linearRampToValueAtTime(0, t + dur);

                osc.connect(gain);
                gain.connect(dry);
                if (toDelay) gain.connect(delay);

                osc.start(t);
                osc.stop(t + dur);
              }

              t += dur;
            }

            return t;
          }

          const lead = [
            { note: "C5", beats: 0.5 }, { note: "E5", beats: 0.5 }, { note: "G5", beats: 0.5 }, { note: "C6", beats: 1.5 },
            { note: "B5", beats: 0.5 }, { note: "C6", beats: 2 },
            { note: "G5", beats: 0.5 }, { note: "C6", beats: 2.5 }
          ];

          const harmony = [
            { note: "E4", beats: 0.5 }, { note: "G4", beats: 0.5 }, { note: "C5", beats: 0.5 }, { note: "E5", beats: 1.5 },
            { note: "D5", beats: 0.5 }, { note: "E5", beats: 2 },
            { note: "C5", beats: 0.5 }, { note: "E5", beats: 2.5 }
          ];

          const bass = [
            { note: "C3", beats: 1 }, { note: "REST", beats: 1 },
            { note: "G3", beats: 1 }, { note: "REST", beats: 1 },
            { note: "C3", beats: 2 },
          ];

          const sparkle = [
            { note: "C6", beats: 0.25 }, { note: "E6", beats: 0.25 }, { note: "G6", beats: 0.25 }, { note: "C7", beats: 0.25 },
            { note: "B6", beats: 0.25 }, { note: "G6", beats: 0.25 }, { note: "E6", beats: 0.25 }, { note: "C6", beats: 0.25 },

            { note: "D6", beats: 0.25 }, { note: "F6", beats: 0.25 }, { note: "A6", beats: 0.25 }, { note: "D7", beats: 0.25 },
            { note: "C7", beats: 0.25 }, { note: "A6", beats: 0.25 }, { note: "F6", beats: 0.25 }, { note: "D6", beats: 0.25 },

            { note: "E6", beats: 0.25 }, { note: "G6", beats: 0.25 }, { note: "C7", beats: 0.25 }, { note: "E7", beats: 0.25 },
            { note: "D7", beats: 0.25 }, { note: "C7", beats: 0.25 }, { note: "G6", beats: 0.25 }, { note: "E6", beats: 0.25 },
          ];

          const t1 = schedule(lead,    { type: "triangle", volume: 0.14, offset: 0.00, detune: +4 });
          const t2 = schedule(harmony, { type: "sine",     volume: 0.10, offset: 0.02, detune: -3 });
          const t3 = schedule(bass,    { type: "square",   volume: 0.06, offset: 0.00, detune:  0, toDelay: false });
          const t4 = schedule(sparkle, { type: "sine",     volume: 0.07, offset: 0.10, detune: +6 });

          const end = Math.max(t1, t2, t3, t4);
          setTimeout(() => ctx.close().catch(() => {}), Math.ceil((end - now + 0.35) * 1000));
        } catch {}
      }

      let yesFinalTimer = null;

      // ------------------ NO button gets huge + runs away ------------------
      let noScale = 1;
      let noDodges = 0;

      function applyNoTransform(extra = "") {
        const capped = Math.min(noScale, 4.5);
        noBtn.style.transform = `translate(${noBtn.dataset.tx || 0}px, ${noBtn.dataset.ty || 0}px) scale(${capped}) ${extra}`;
      }

      // starts dodging after 2 clicks
      noBtn.addEventListener("mouseenter", () => {
        if (noDodges < 2) return;

        const rect = noBtn.getBoundingClientRect();
        const pad = 12;

        const maxX = window.innerWidth - rect.width - pad;
        const maxY = window.innerHeight - rect.height - pad;

        const tx = Math.floor(Math.random() * maxX) - rect.left + pad;
        const ty = Math.floor(Math.random() * maxY) - rect.top + pad;

        noBtn.dataset.tx = tx;
        noBtn.dataset.ty = ty;

        noBtn.style.transition = "transform 0.15s ease";
        applyNoTransform();
      });

      yesBtn.addEventListener("click", () => {
        setImageTry(GIFS.yesMain, "YES GIF failed to load.");
        hint.textContent = "You are now my Valentine FOREVER...er I mean um, for uh 2026! ðŸ’™";
        noBtn.style.display = "none";

        playGlueSong();
        confetti({ particleCount: 250, spread: 80, origin: { y: 0.6 } });

        if (yesFinalTimer) clearTimeout(yesFinalTimer);
        yesFinalTimer = setTimeout(() => {
          setImageTry(GIFS.yesFinal, "Final Eevee GIF failed to load.");
        }, 2000);
      });

      // REPLACED NO handler: grows + wiggles + eventually runs away
      noBtn.addEventListener("click", () => {
        setImageTry(GIFS.no, "NO GIF failed to load.");
        hint.textContent = "No (Are you sure about that?) ðŸ˜³";

        noScale *= 1.35;
        noDodges += 1;

        const capped = Math.min(noScale, 4.5);

        noBtn.animate(
          [
            { transform: `translate(${noBtn.dataset.tx || 0}px, ${noBtn.dataset.ty || 0}px) scale(${capped}) rotate(0deg)` },
            { transform: `translate(${noBtn.dataset.tx || 0}px, ${noBtn.dataset.ty || 0}px) scale(${capped}) rotate(-7deg)` },
            { transform: `translate(${noBtn.dataset.tx || 0}px, ${noBtn.dataset.ty || 0}px) scale(${capped}) rotate(7deg)` },
            { transform: `translate(${noBtn.dataset.tx || 0}px, ${noBtn.dataset.ty || 0}px) scale(${capped}) rotate(0deg)` },
          ],
          { duration: 220, iterations: 1 }
        );

        applyNoTransform();
      });
    </script>
  </body>
</html>
